import pandas as pd

from censyn import analytics
from ..datasources.parquetdatasource import ParquetDataSource
from ..results.result import AssertBooleanResult


class Asserts:

    def __init__(self):
        self.value_dict()

    @staticmethod
    def get_dataframe_details(df):
        return {'df': df.describe()}

    @staticmethod
    def count_less_than_column(df, column_name, less_then_value):
        return {'count': df[df[column_name] < less_then_value][column_name].count(),
                'column_name':column_name}

    @staticmethod
    def count_greater_than(column_name, count, greater_than, expected_value):
        return AssertBooleanResult(value=count > greater_than,
                                   expected_value=expected_value,
                                   description=f'Feature {column_name} had {count} values outside the valid list')

    @staticmethod
    def list_count(df, column, value_list, has_null):
        if (has_null):
            return {'count': len(df.index) - df[df[column].isin(value_list)][column].count() - df[column].isna().sum(),
                    'column_name': column}
        else:
            return {'count': df[~(df[column].isin(value_list))][column].count(), 'column_name': column}

    @staticmethod
    def range_count(df, column, value_list, has_null):
        if 'tenthsPlace' in df.columns:
            del df['tenthsPlace']

        df['tenthsPlace'] = df[column].apply(lambda x: 0 if (pd.isnull(x)) else int((x*10)%10))

        lowerBound = value_list[0]
        upperBound = value_list[1]

        if (has_null):
            return {'count': len(df.index) - df[(df['tenthsPlace'] == 0)]['tenthsPlace'].count() +
                             df[(df[column] < lowerBound) | (df[column] > upperBound)][column].count(),
                    'column_name': column}
        else:
            return {'count': df['tenthsPlace'].sum() +
                             df[(df[column] < lowerBound) |
                                (df[column] > upperBound)][column].count() + pd.isnull(df[column]).sum(),
                    'column_name': column}
    @staticmethod
    def leading_zeros_count(df, column, value_list, has_null):

        if column == 'PUMA':
            if 'p_int' in df.columns:
                del df['p_int']

            df['p_int'] = df[column].apply(lambda x: 0 if (pd.isnull(x)) else int(x))
            lowerBound = int(value_list[0])
            upperBound = int(value_list[1])

            return {'count': df[(df['p_int']< lowerBound) | (df['p_int'] > upperBound)]['p_int'].count(),
                    'column_name':column}

        if column == 'POWPUMA':
            if 'p_int' in df.columns:
                del df['p_int']

            value1 = int(value_list[0])
            lowerBound = int(value_list[1][0])
            upperBound = int(value_list[1][1])

            df['p_int'] = df[column].apply(lambda x: 0 if (pd.isnull(x)) else int(x))

            return {'count': len(df.index)-pd.isnull(df[column]).sum()-df[((df['p_int'] >= lowerBound) &
                                                                           (df['p_int'] <= upperBound)) |
                                                                          (df['p_int'] == value1)]['p_int'].count(),
                    'column_name': column}

        if column == 'MIGPUMA':
            if 'p_int' in df.columns:
                del df['p_int']

            df['p_int'] = df[column].apply(lambda x: 0 if (pd.isnull(x)) else int(x.lstrip("0")))

            value1 = int(value_list[0])
            value2 = int(value_list[1])
            lowerBound = int(value_list[2][0])
            upperBound = int(value_list[2][1])

            return {'count': len(df.index)-pd.isnull(df[column]).sum()-
                             df[(((df['p_int'] >= lowerBound) &
                                  (df['p_int'] <= upperBound)) |
                                 (df['p_int'] == value1) |
                                 (df['p_int'] == value2))]['p_int'].count(),
            'column_name': column}



    def value_dict(self):
        self.list_validation_no_nulls = {
            # 'ST'      : ['01', '02', '04', '05', '06', '08', '09',
            #              '10', '11', '12', '13', '15', '16', '17', '18' '19',
            #              '20', '21', '22', '23', '24', '25', '26', '27', '28', '29',
            #              '30', '31', '32', '33', '34', '35', '36' ,'37', '38', '39',
            #              '40', '41', '42', '44', '45', '46', '47', '48', '49',
            #              '50', '51', '53', '54', '55', '56',
            #              '72'],
            'CIT'     : ['1', '2', '3', '4', '5'],
            'DEAR'    : ['1', '2'],


            'DEYE'    : ['1', '2'],
            'HINS1'   : ['1', '2'],
            'HINS2'   : ['1', '2'],
            'HINS3'   : ['1', '2'],
            'HINS4'   : ['1', '2'],
            'HINS5'   : ['1', '2'],
            'HINS6'   : ['1', '2'],
            'HINS7'   : ['1', '2'],
            'MAR'     : ['1', '2', '3', '4', '5'],
            'RELP'    : ['00','01', '02', '03', '04', '05', '06', '07', '08', '09',
                         '10', '11', '12', '13', '14', '15', '16', '17'],
            'SEX'     : ['1', '2'],
            'ANC'     : ['1', '2', '3', '4'],
            'ANC1P'   : ['001', '003', '005', '008', '009', '011', '012',
                         '020', '021', '022', '024', '026', '032',
                         '040', '046', '049', '050', '051', '068',
                         '077', '078', '082', '084', '087', '088', '089',
                         '091', '094', '097', '098', '099',
                         '100', '102', '103', '109', '111', '112', '114', '115',
                         '122', '124', '125', '128', '129', '130', '131',
                         '142', '144', '146', '148', '152', '153', '154',
                         '168', '169', '170', '171', '176', '177', '178', '179',
                         '181', '183', '185', '187', '190', '194', '195',
                         '200', '210', '211', '212', '213', '215', '218', '219',
                         '221', '222', '223', '224', '225', '226', '227',
                         '231', '232', '233', '234', '235', '236', '237', '238', '239',
                         '249', '250', '251', '252', '261', '271', '275',
                         '290', '291', '295',
                         '300', '301', '302', '308', '310', '314',
                         '322', '325', '329', '330', '331', '335', '336',
                         '359', '360', '370',
                         '400', '402', '406', '411', '416', '417', '419',
                         '421', '425', '427' ,'429', '431', '434', '435',
                         '442', '465', '483', '484', '490', '495', '496', '499',
                         '508', '510', '515', '522', '523', '529', '534',
                         '541', '553', '564', '566', '568', '570','576',
                         '587', '588', '598', '599',
                         '600', '603', '607', '609', '615','618', '620',
                         '650', '680', '690',
                         '700', '703', '706', '707', '712', '714', '720',
                         '730', '740', '748', '750', '765', '768', '770', '776',
                         '782', '785', '793', '795', '799',
                         '800', '803', '808', '811', '814', '815',
                         '820', '821', '822', '825', '841', '850', '899',
                         '900', '901', '902', '903', '904', '907',
                         '913', '914', '917', '918', '919',
                         '920', '921', '922', '924', '925', '927', '929',
                         '931', '935', '937', '939', '940', '983',
                         '994', '995', '996', '997', '998', '999'],
            'ANC2P'   : ['001', '003', '005', '008', '009', '011', '012',
                         '020', '021', '022', '024', '026', '032',
                         '040', '046', '049', '050', '051', '068',
                         '077', '078', '082', '084', '087', '088', '089',
                         '091', '094', '097', '098', '099',
                         '100', '102', '103', '109', '111', '112', '114', '115',
                         '122', '124', '125', '128', '129', '130', '131',
                         '142', '144', '146', '148', '152', '153', '154',
                         '168', '169', '170', '171', '176', '177', '178', '179',
                         '181', '183', '185', '187', '190', '194', '195',
                         '200', '210', '211', '212', '213', '215', '218', '219',
                         '221', '222', '223', '224', '225', '226', '227',
                         '231', '232', '233', '234', '235', '236', '237', '238', '239',
                         '249', '250', '251', '252', '261', '271', '275',
                         '290', '291', '295',
                         '300', '301', '302', '308', '310', '314',
                         '322', '325', '329', '330', '331', '335', '336',
                         '359', '360', '370',
                         '400', '402', '406', '411', '416', '417', '419',
                         '421', '425', '427' ,'429', '431', '434', '435',
                         '442', '465', '483', '484', '490', '495', '496', '499',
                         '508', '510', '515', '522', '523', '529', '534',
                         '541', '553', '564', '566', '568', '570','576',
                         '587', '588', '598', '599',
                         '600', '603', '607', '609', '615','618', '620',
                         '650', '680', '690',
                         '700', '703', '706', '707', '712', '714', '720',
                         '730', '740', '748', '750', '765', '768', '770', '776',
                         '782', '785', '793', '795', '799',
                         '800', '803', '808', '811', '814', '815',
                         '820', '821', '822', '825', '841', '850', '899',
                         '900', '901', '902', '903', '904', '907',
                         '913', '914', '917', '918', '919',
                         '920', '921', '922', '924', '925', '927', '929',
                         '931', '935', '937', '939', '940', '983',
                         '994', '995', '996', '997', '998', '999'],
            'DIS'     : ['1', '2'],
            'HICOV'   : ['1', '2'],
            'HISP'    : ['01', '02', '03', '04', '05', '06', '07', '08', '09',
                         '10', '11', '12', '13', '14', '15', '16', '17', '18', '19',
                         '20', '21', '22', '23', '24'],
            'NATIVITY': ['1', '2'],
            'OC'      : ['0', '1'],
            'POBP'    : ['1', '2', '4', '5', '6', '8', '9',
                         '10', '11', '12', '13', '15', '16', '17', '18', '19',
                         '20', '21', '22', '23', '24', '25', '26', '27', '28', '29',
                         '30', '31', '32', '33', '34', '35', '36', '37', '38', '39',
                         '40', '41', '42', '44', '45', '46', '47', '48'  '49',
                         '50', '51', '53', '54', '55', '56', '60' '66', '69', '72', '78',
                         '100', '102', '103', '104', '105', '106', '108', '109',
                         '110', '116', '117', '118', '119',
                         '120', '126', '127', '128', '129',
                         '130', '132', '134', '136', '137', '138', '139',
                         '140', '147', '148', '149',
                         '150', '151', '152', '154', '156',' 157', '158', '159',
                         '160', '161', '162', '163', '164', '165', '168', '169',
                         '200', '202', '203', '205', '206', '207', '208', '209',
                         '210', '211', '212', '213', '214', '215', '216', '217', '218',
                         '222', '223', '224', '226', '229',
                         '231', '233', '235', '236', '238', '239',
                         '240', '242', '243', '245', '246', '247', '248', '249',
                         '253', '254',
                         '300', '301', '303',
                         '310', '311', '312', '313', '314', '315', '316',
                         '321', '323', '324', '327', '328', '329',
                         '330', '332', '333', '339',
                         '340', '341', '343', '344',
                         '360', '361', '362', '363', '364', '365', '368', '369',
                         '370', '372', '373', '374', '399',
                         '400', '407', '408',
                         '412', '414', '416', '417',
                         '420', '421', '423', '427', '429',
                         '430', '436',
                         '440', '444', '447', '448', '449',
                         '451', '453', '454', '457', '459',
                         '460', '461', '462', '463', '464', '467', '468',
                         '501', '508', '511', '512', '515', '523', '527', '554'],
            'PRIVCOV' : ['1', '2'],
            'PUBCOV'  : ['1', '2'],
            'QTRBIR'  : ['1', '2', '3', '4'],
            'RAC1P'   : ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
            'RAC2P'   : ['01', '02', '03', '04', '05', '06', '07', '08', '09',
                         '10', '11', '12', '13', '14', '15', '16', '17', '18', '19',
                         '20', '21', '22', '23', '24', '25', '26', '27', '28', '29',
                         '30', '31', '32', '33','34','35','36','37','38','39',
                         '40', '41', '42', '43', '44', '45', '46', '47', '48', '49',
                         '50', '51', '52', '53', '54', '55', '56', '57', '58', '59',
                         '60','61','62','63','64','65', '66', '67', '68'],
            'RAC3P'   : ['001', '002', '003', '004', '005', '006', '007', '008', '009', '010',
                         '011', '012', '013', '014', '015', '016', '017', '018', '019',
                         '020', '021', '022', '023', '024', '025', '026', '027', '028', '029',
                         '030', '031', '032', '033', '034', '035', '036', '037', '038', '039',
                         '040', '041', '042', '043', '044', '045', '046', '047', '048', '049',
                         '050', '051', '052', '053', '054', '055', '056', '057', '058', '059',
                         '060', '061', '062', '063', '064', '065', '066', '067', '068', '069',
                         '070', '071', '072', '073', '074', '075', '076', '077', '078', '079',
                         '080', '081', '082', '083', '084', '085', '086', '087', '088', '089',
                         '090', '091', '092', '093', '094', '095', '096', '097', '098', '099', '100'],
            'RACAIAN' : ['0', '1'],
            'RACASN'  : ['0', '1'],
            'RACBLK'  : ['0', '1'],
            'RACNH'   : ['0', '1'],
            'RACNUM'  : ['1', '2', '3', '4', '5', '6'],
            'RACPI'   : ['0', '1'],
            'RACSOR'  : ['0', '1'],
            'RACWHT'  : ['0', '1'],
            'RC'      : ['0', '1'],
            'WAOB'    : ['1', '2', '3', '4', '5', '6', '7', '8']
        }
        self.list_validation_has_nulls = {
            'CITWP'  : [1928.0, 1929.0, 1934.0,
                        1940.0, 1943.0, 1945.0, 1946.0, 1948.0, 1949.0,
                        1950.0, 1951.0, 1952.0, 1953.0, 1954.0, 1955.0, 1956.0, 1957.0, 1958.0, 1959.0,
                        1960.0, 1961.0, 1962.0, 1963.0, 1964.0, 1965.0, 1966.0, 1967.0, 1968.0, 1969.0,
                        1970.0, 1971.0, 1972.0, 1973.0, 1974.0, 1975.0, 1976.0, 1977.0, 1978.0, 1979.0,
                        1980.0, 1981.0, 1982.0, 1983.0, 1984.0, 1985.0, 1986.0, 1987.0, 1988.0, 1989.0,
                        1990.0, 1991.0, 1992.0, 1993.0, 1994.0, 1995.0, 1996.0, 1997.0, 1998.0, 1999.0,
                        2000.0, 2001.0, 2002.0, 2003.0, 2004.0, 2005.0, 2006.0, 2007.0, 2008.0, 2009.0,
                        2010.0, 2011.0, 2012.0, 2013.0, 2014.0, 2015.0, 2016.0],
            'COW'    : ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
            'DDRS'   : ['1', '2'],
            'DECADE' : ['1', '2', '3', '4', '5', '6', '7'],
            'DOUT'   : ['1', '2'],
            'DPHY'   : ['1', '2'],
            'DRAT'   : ['1', '2', '3', '4', '5', '6'],
            'DRATX'  : ['1', '2'],
            'DREM'   : ['1', '2'],
            'ENG'    : ['1', '2', '3', '4'],
            'FER'    : ['1', '2'],
            'GCL'    : ['1', '2'],
            'GCM'    : ['1', '2', '3','4','5'],
            'GCR'    : ['1', '2'],
            'JWRIP'  : [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0],
            'JWTR'   : ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'],
            'LANP'   : ['1000', '1025', '1055', '1069',
                        '1110', '1120', '1125', '1130', '1132', '1134',
                        '1140', '1141', '1142', '1155', '1170', '1175',
                        '1200', '1210', '1220', '1231', '1235', '1242',
                        '1250', '1260', '1262', '1263',
                        '1270', '1273', '1274', '1275', '1276', '1277', '1278',
                        '1281', '1283', '1288', '1290', '1292',
                        '1315', '1327', '1340', '1350', '1360', '1380',
                        '1420', '1435', '1440', '1450',
                        '1500', '1525', '1530', '1540', '1564', '1565', '1582',
                        '1675', '1690',
                        '1730', '1737', '1750', '1765',
                        '1900', '1960', '1970',
                        '2000', '2030', '2050',
                        '2100', '2160',
                        '2270',
                        '2350',
                        '2430', '2475',
                        '2525', '2535', '2560', '2575',
                        '2715', '2770',
                        '2850',
                        '2910', '2920', '2950',
                        '3150', '3190',
                        '3220', '3270',
                        '3350',
                        '3420',
                        '3500', '3570',
                        '3600',
                        '4500', '4545', '4560', '4565', '4590',
                        '4640',
                        '4830', '4840', '4880',
                        '4900',
                        '5150',
                        '5345',
                        '5525',
                        '5645',
                        '5845',
                        '5900', '5940', '5950',
                        '6120',
                        '6205', '6230', '6290',
                        '6300', '6370',
                        '6500',
                        '6795',
                        '6800', '6839',
                        '6930', '6933', '6936',
                        '7019', '7032', '7039', '7050', '7059', '7060',
                        '7124',
                        '7300',
                        '9500',
                        '9999'],
            'LANX'   : ['1', '2'],
            'MARHD'  : ['1', '2'],
            'MARHM'  : ['1', '2'],
            'MARHT'  : ['1', '2', '3'],
            'MARHW'  : ['1', '2'],
            'MIG'    : ['1', '2', '3'],
            'MIL'    : ['1', '2', '3', '4'],
            'MLPA'   : ['0', '1'],
            'MLPB'   : ['0', '1'],
            'MLPCD'  : ['0', '1'],
            'MLPE'   : ['0', '1'],
            'MLPFG'  : ['0', '1'],
            'MLPH'   : ['0', '1'],
            'MLPI'   : ['0', '1'],
            'MLPJ'   : ['0', '1'],
            'MLPK'   : ['0', '1'],
            'NWAB'   : ['1', '2', '3'],
            'NWAV'   : ['1', '2', '3', '4', '5'],
            'NWLA'   : ['1', '2', '3'],
            'NWLK'   : ['1', '2', '3'],
            'NWRE'   : ['1', '2', '3'],
            'SCH'    : ['1', '2', '3'],
            'SCHG'   : ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10',
                        '11', '12', '13', '14', '15', '16'],
            'SCHL'   : ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10',
                        '11', '12', '13', '14', '15', '16', '17', '18', '19', '20',
                        '21', '22', '23', '24'],
            'WKL'    : ['1', '2', '3'],
            'WKW'    : ['1', '2', '3', '4', '5', '6'],
            'WRK'    : ['1', '2'],
            'DRIVESP': ['1', '2', '3', '4', '5', '6'],
            'ESP'    : ['1', '2', '3', '4', '5', '6', '7', '8'],
            'ESR'    : ['1', '2', '3', '4', '5', '6'],
            'FOD1P'  : ['1100','1101','1102','1103', '1104', '1105', '1106',
                        '1199',
                        '1301', '1302', '1303',
                        '1401',
                        '1501',
                        '1901', '1902', '1903', '1904',
                        '2001',
                        '2100', '2101', '2102', '2105', '2106', '2107',
                        '2201',
                        '2300', '2301', '2303', '2304', '2305', '2306', '2307', '2308', '2309',
                        '2310', '2311', '2312', '2313', '2314',
                        '2399',
                        '2400', '2401', '2402', '2403', '2404', '2405', '2406', '2407', '2408', '2409',
                        '2410', '2411', '2412', '2413', '2414', '2415', '2416', '2417', '2418', '2419',
                        '2499',
                        '2500', '2501', '2502', '2503', '2504',
                        '2599',
                        '2601', '2602', '2603',
                        '2901',
                        '3201', '3202',
                        '3301', '3302',
                        '3401', '3402',
                        '3501',
                        '3600', '3601', '3602', '3603', '3604', '3605', '3606', '3607', '3608', '3609',
                        '3611',
                        '3699',
                        '3700', '3701', '3702',
                        '3801',
                        '4000', '4001', '4002', '4005', '4006', '4007',
                        '4101',
                        '4801',
                        '4901',
                        '5000', '5001', '5002', '5003', '5004', '5005', '5006', '5007', '5008',
                        '5098',
                        '5102',
                        '5200', '5201', '5202', '5203', '5205', '5206',
                        '5299',
                        '5301',
                        '5401', '5402', '5403', '5404',
                        '5500', '5501', '5502', '5503', '5504', '5505', '5506', '5507',
                        '5599',
                        '5601',
                        '5701',
                        '5901',
                        '6000', '6001', '6002', '6003', '6004', '6005', '6006', '6007',
                        '6099',
                        '6100', '6102', '6103', '6104', '6105', '6106', '6107', '6108', '6109',
                        '6110',
                        '6199',
                        '6200', '6201', '6202', '6203', '6204', '6205', '6206', '6207', '6209',
                        '6210', '6211', '6212',
                        '6299',
                        '6402',
                        '6403'],
            'FOD2P'  : ['1100', '1101', '1102', '1103', '1104', '1105', '1106', '1199',
                        '1301', '1302', '1303',
                        '1401',
                        '1501',
                        '1901', '1902', '1903', '1904',
                        '2001',
                        '2100', '2101', '2102', '2105', '2106', '2107',
                        '2201',
                        '2300', '2301', '2303', '2304', '2305', '2306', '2307', '2308', '2309',
                        '2310', '2311', '2312', '2313', '2314', '2399',
                        '2400', '2401', '2402', '2403', '2404', '2405', '2406', '2407', '2408', '2409',
                        '2410', '2411', '2412', '2413', '2414', '2415', '2416', '2417', '2418', '2419', '2499',
                        '2500', '2501', '2502', '2503', '2504', '2599',
                        '2601', '2602', '2603',
                        '2901',
                        '3201', '3202',
                        '3301', '3302',
                        '3401', '3402',
                        '3501',
                        '3600', '3601', '3602', '3603', '3604', '3605', '3606', '3607', '3608', '3609', '3611', '3699',
                        '3700', '3701', '3702',
                        '3801',
                        '4000', '4001', '4002', '4005', '4006', '4007',
                        '4101',
                        '4801',
                        '4901',
                        '5000', '5001', '5002', '5003', '5004', '5005', '5006', '5007', '5008', '5098',
                        '5102',
                        '5200', '5201', '5202', '5203', '5205', '5206', '5299',
                        '5301',
                        '5401', '5402', '5403', '5404',
                        '5500', '5501', '5502', '5503', '5504', '5505', '5506', '5507', '5599',
                        '5601',
                        '5701',
                        '5901',
                        '6000', '6001', '6002', '6003', '6004', '6005', '6006', '6007', '6099',
                        '6100', '6102', '6103', '6104', '6105', '6106', '6107', '6108', '6109', '6110', '6199',
                        '6200', '6201', '6202', '6203', '6204', '6205', '6206', '6207', '6209', '6210', '6211', '6212',
                        '6299',
                        '6402',
                        '6403'],
            'INDP'   : ['0170', '0180', '0190',
                        '0270', '0280', '0290',
                        '0370', '0380', '0390',
                        '0470', '0490',
                        '0570', '0580', '0590',
                        '0670', '0680', '0690',
                        '0770',
                        '1070', '1080', '1090',
                        '1170', '1180', '1190',
                        '1270', '1280', '1290',
                        '1370', '1390', '1470', '1480', '1490',
                        '1570', '1590',
                        '1670', '1680', '1690',
                        '1770', '1790',
                        '1870', '1880', '1890',
                        '1990',
                        '2070', '2090',
                        '2170', '2180', '2190',
                        '2270', '2280', '2290',
                        '2370', '2380', '2390',
                        '2470', '2480', '2490',
                        '2570', '2590',
                        '2670', '2680', '2690',
                        '2770', '2780', '2790',
                        '2870', '2880', '2890',
                        '2970', '2980', '2990',
                        '3070', '3080', '3095',
                        '3170', '3180', '3190',
                        '3365', '3370', '3380', '3390',
                        '3470', '3490',
                        '3570', '3580', '3590',
                        '3670', '3680', '3690',
                        '3770', '3780', '3790',
                        '3875', '3895',
                        '3960', '3970', '3980', '3990',
                        '4070', '4080', '4090',
                        '4170', '4180', '4195',
                        '4265', '4270', '4280', '4290',
                        '4370', '4380', '4390',
                        '4470', '4480', '4490',
                        '4560', '4570', '4580', '4585', '4590',
                        '4670', '4680', '4690',
                        '4770', '4780', '4795',
                        '4870', '4880', '4890',
                        '4970', '4980', '4990',
                        '5070', '5080', '5090',
                        '5170', '5180', '5190',
                        '5275', '5280', '5295',
                        '5370', '5380', '5390',
                        '5470', '5480', '5490',
                        '5570', '5580', '5590', '5591', '5592',
                        '5670', '5680', '5690',
                        '5790',
                        '6070', '6080', '6090',
                        '6170', '6180', '6190',
                        '6270', '6280', '6290',
                        '6370', '6380', '6390',
                        '6470', '6480', '6490',
                        '6570', '6590',
                        '6670', '6672', '6680', '6690', '6695',
                        '6770', '6780',
                        '6870', '6880', '6890',
                        '6970', '6990',
                        '7070', '7080',
                        '7170', '7180', '7190',
                        '7270', '7280', '7290',
                        '7370', '7380', '7390',
                        '7460', '7470', '7480', '7490',
                        '7570', '7580', '7590',
                        '7670', '7680', '7690',
                        '7770', '7780', '7790',
                        '7860', '7870', '7880', '7890',
                        '7970', '7980', '7990',
                        '8070', '8080', '8090',
                        '8170', '8180', '8190',
                        '8270', '8290',
                        '8370', '8380', '8390',
                        '8470',
                        '8560', '8570', '8580', '8590',
                        '8660', '8670', '8680', '8690',
                        '8770', '8780', '8790',
                        '8870', '8880',
                        '8970', '8980', '8990',
                        '9070', '9080', '9090',
                        '9160', '9170', '9180', '9190',
                        '9290',
                        '9370', '9380', '9390',
                        '9470', '9480', '9490',
                        '9570', '9590',
                        '9670', '9680', '9690',
                        '9770', '9780', '9790',
                        '9870',
                        '9920'],
            'JWAP'   : ['001', '002', '003', '004', '005', '006', '007', '008', '009',
                        '010', '011', '012', '013', '014', '015', '016', '017', '018', '019',
                        '020', '021', '022', '023', '024', '025', '026', '027', '028', '029',
                        '030', '031', '032', '033', '034', '035', '036', '037', '038', '039',
                        '040', '041', '042', '043', '044', '045', '046', '047', '048', '049',
                        '050', '051', '052', '053', '054', '055', '056', '057', '058', '059',
                        '060', '061', '062', '063', '064', '065', '066', '067', '068', '069',
                        '070', '071', '072', '073', '074', '075', '076', '077','078', '079',
                        '080', '081', '082', '083', '084', '085', '086', '087', '088', '089',
                        '090', '091', '092', '093', '094', '095', '096', '097', '098', '099',
                        '100', '101', '102', '103', '104', '105', '106', '107', '108', '109',
                        '110', '111', '112', '113', '114', '115', '116', '117', '118', '119',
                        '120', '121', '122', '123', '124', '125', '126', '127', '128', '129',
                        '130', '131', '132', '133', '134', '135', '136', '137', '138', '139',
                        '140', '141', '142', '143', '144', '145', '146', '147', '148', '149',
                        '150', '151', '152', '153', '154', '155', '156', '157', '158', '159',
                        '160', '161', '162', '163', '164', '165', '166', '167', '168', '169',
                        '170', '171', '172', '173', '174', '175', '176', '177', '178', '179',
                        '180', '181', '182', '183', '184', '185', '186', '187', '188', '189',
                        '190', '191', '192', '193', '194', '195', '196', '197', '198', '199',
                        '200', '201', '202', '203', '204', '205', '206', '207', '208', '209',
                        '210', '211', '212', '213', '214', '215', '216', '217', '218', '219',
                        '220', '221', '222', '223', '224', '225', '226', '227', '228', '229',
                        '230', '231', '232', '233', '234', '235', '236', '237', '238', '239',
                        '240', '241', '242', '243', '244', '245', '246', '247', '248', '249',
                        '250', '251', '252', '253', '254', '255', '256', '257', '258', '259',
                        '260', '261', '262', '263', '264', '265', '266', '267', '268', '269',
                        '270', '271', '272', '273', '274', '275', '276', '277', '278', '279',
                        '280', '281', '282', '283', '284', '285'],
            'JWDP'   : ['001', '002', '003', '004', '005', '006', '007', '008', '009',
                        '010', '011', '012', '013', '014', '015', '016', '017', '018', '019',
                        '020', '021', '022', '023', '024', '025', '026', '027', '028', '029',
                        '030', '031', '032', '033', '034', '035', '036', '037', '038', '039',
                        '040', '041', '042', '043', '044', '045', '046', '047', '048', '049',
                        '050', '051', '052', '053', '054', '055', '056', '057', '058', '059',
                        '060', '061', '062', '063', '064', '065', '066', '067', '068', '069',
                        '070', '071', '072', '073', '074', '075', '076', '077', '078', '079',
                        '080', '081', '082', '083', '084', '085', '086', '087', '088', '089',
                        '090', '091', '092', '093', '094', '095', '096', '097', '098', '099',
                        '100', '101', '102', '103', '104', '105', '106', '107', '108', '109',
                        '110', '111', '112', '113', '114', '115', '116', '117', '118', '119',
                        '120', '121', '122', '123', '124', '125', '126', '127', '128', '129',
                        '130', '131', '132', '133', '134', '135', '136', '137', '138', '139',
                        '140', '141', '142', '143', '144', '145', '146', '147', '148', '149',
                        '150'],
            'MIGSP'  : ['001', '002', '004', '005', '006', '008', '009', '010',
                        '011', '012', '013', '015', '016', '017', '018', '019',
                        '020', '021', '022', '023', '024', '025', '026', '027', '028', '029',
                        '030', '031', '032', '033', '034', '035', '036', '037', '038', '039',
                        '040', '041', '042', '044', '045', '046', '047', '048', '049',
                        '050', '051', '053', '054', '055', '056', '072',
                        '109', '110', '111', '113', '114', '120', '134', '138', '139', '163',
                        '200', '207', '210', '213', '215', '217', '229', '231', '233', '235',
                        '240', '242', '243', '247', '251', '252', '253',
                        '301', '303', '312', '313', '314', '317', '327', '329', '332', '333',
                        '344', '362', '364', '374',
                        '414', '440', '463', '467', '468',
                        '501', '555'],
            'MSP'    : ['1', '2', '3', '4', '5', '6'],


            # 'NAICSP': ['111',      '112',      '1133',     '113M',     '114',      '115',
            #             '211',      '2121',     '2122',     '2123',     '213',
            #             '2211P',    '2212P',    '22132',    '2213M',    '221MP',    '22S',      '23',
            #             '3113',     '3114',     '3115',     '3116',     '311811',   '3118Z',    '311M1',   '311M2',
            #             '311S',     '3121',     '3122',     '3131',     '3132Z',    '3133',     '31411',   '314Z',
            #             '3152',     '3159',     '3162',     '316M',     '31M',
            #             '3211',     '3212',     '32199M',   '3219ZM',   '3221',     '32221',    '3222M',   '3231',
            #             '3241M',    '32411',    '3252',     '3253',     '3254',     '3255',     '3256',    '325M',
            #             '3261',     '32621',    '3262M',    '32711',    '327120',   '3272',     '3279',    '327M',
            #             '3313',     '3314',     '3315',     '331M',     '3321',     '3322',     '3327',    '3328',
            #             '33299M',   '332M',     '332MZ',    '33311',    '3331M',    '3333',     '3335',    '3336',
            #             '333MS',    '3341',     '3345',     '334M1',    '334M2',    '3352',     '335M',    '33641M1',
            #             '33641M2',  '3365',     '3366',     '3369',     '336M',     '337',      '3391',
            #             '3399M',    '3399ZM',   '33MS',     '3MS',
            #             '4231',     '4232',     '4233',     '4234',     '4235',     '4236',     '4237',    '4238',
            #             '42393',    '4239Z',    '4241',     '4243',     '4244',     '4245',     '4247',    '4248',
            #             '42491',    '4249Z',    '424M',     '4251',     '42S' ,
            #             '4411',     '4412',     '4413',     '442',      '443141',   '443142',   '44413',   '4441Z',
            #             '4442',     '4451',     '4452'      '4453',     '44611',    '446Z',     '447',     '44821',
            #             '4483 ',    '4481',
            #             '45113',    '45114',    '4511M',    '45121',    '45211',    '4529',     '4531',    '45321',
            #             '45322',    '4533',     '4539',     '454111',   '454112',   '454113',   '4542',    '454310',
            #             '45439',    '4MS',
            #             '481',      '482',      '483',      '484',      '4853',     '485M',     '486',     '487',
            #             '488',      '491',      '492',      '493',
            #             '51111',    '5111Z',    '5112',     '5121',     '5122',     '515',      '5171',    '517Z',
            #             '5182',     '51912',    '51913',    '5191ZM',   '5221M',    '522M',     '524',     '52M1',
            #             '52M2',     '531',      '5321',     '53223',    '532M',     '53M',
            #             '5411',     '5412',     '5413',     '5414',     '5415',     '5416',     '5417',    '5418',
            #             '54194',    '5419Z',    '55',
            #             '5613',     '5614',     '5615',     '5616',     '56173',    '5617Z',    '561M',    '562',
            #             '6111',     '611M1',    '611M2',    '611M3',    '6211',     '6212',     '62131',   '62132',
            #             '6213ZM',   '6214',     '6216',     '621M',     '622',      '6231',     '623M',    '6241',
            #             '6242',     '6243',     '6244',
            #             '711',      '712',      '71395',    '713Z',     '7211',     '721M',     '7224',    '722Z',
            #             '811192',   '8111Z',    '8112',     '8113',     '8114',     '812111',   '812112',  '8121M',
            #             '8122',     '8123',     '8129',     '8131',     '81393',    '8139Z',    '813M',    '814',
            #             '92113',    '92119',    '9211MP',   '923',      '92M1',     '92M2',     '92MP',    '928P',
            #             '928110P1', '928110P2', '928110P3', '928110P4', '928110P5', '928110P6', '928110P7', '9920'],

            'NOP'    : ['1', '2', '3', '4', '5', '6', '7', '8'],
            'OCCP'   : ['0010', '0020', '0040', '0050', '0060', '0100', '0110', '0120',
                        '0135', '0136', '0137', '0140', '0150', '0160',
                        '0205', '0220', '0230',
                        '0300', '0310', '0330', '0340', '0350', '0360',
                        '0410', '0420', '0425', '0430',
                        '0500', '0510', '0520', '0530', '0540', '0565',
                        '0600', '0630', '0640', '0650',
                        '0700', '0710', '0725', '0726', '0735', '0740',
                        '0800', '0810', '0820', '0830', '0840', '0850', '0860',
                        '0900', '0910', '0930', '0940', '0950', '1005', '1006', '1007',
                        '1010', '1020', '1030', '1050', '1060', '1105', '1106', '1107',
                        '1200', '1220', '1240',
                        '1300', '1310', '1320', '1340', '1350', '1360',
                        '1400', '1410', '1420', '1430', '1440', '1450', '1460',
                        '1520', '1530', '1540', '1550', '1560',
                        '1600', '1610', '1640', '1650',
                        '1700', '1710', '1720', '1740', '1760',
                        '1800', '1820', '1840', '1860',
                        '1900', '1910', '1920', '1930', '1965',
                        '2000', '2010', '2015', '2016', '2025', '2040', '2050', '2060',
                        '2100', '2105', '2145', '2160', '2200',
                        '2300', '2310', '2320', '2330', '2340',
                        '2400', '2430', '2440', '2540', '2550', '2600', '2630',
                        '2700', '2710', '2720', '2740', '2750', '2760',
                        '2800', '2810', '2825', '2830', '2840', '2850', '2860',
                        '2900', '2910', '2920',
                        '3000', '3010', '3030', '3040', '3050', '3060',
                        '3110', '3120', '3140', '3150', '3160',
                        '3200', '3210', '3220', '3230', '3245', '3250', '3255', '3256', '3258', '3260',
                        '3300', '3310', '3320', '3400', '3420',
                        '3500', '3510', '3520', '3535', '3540',
                        '3600', '3610', '3620', '3630', '3640', '3645', '3646', '3647', '3648', '3649', '3655',
                        '3700', '3710', '3720', '3730', '3740', '3750',
                        '3800', '3820', '3840', '3850',
                        '3900','3910', '3930', '3940', '3945', '3955',
                        '4000', '4010', '4020', '4030', '4040', '4050', '4060',
                        '4110', '4120', '4130', '4140', '4150',
                        '4200', '4210', '4220', '4230', '4240', '4250',
                        '4300', '4320', '4340', '4350',
                        '4400', '4410', '4420', '4430', '4460', '4465',
                        '4500', '4510', '4520', '4530', '4540',
                        '4600', '4610', '4620', '4640', '4650',
                        '4700', '4710', '4720', '4740', '4750', '4760',
                        '4800', '4810', '4820', '4830', '4840', '4850',
                        '4900', '4920', '4930', '4940', '4950', '4965',
                        '5000', '5010', '5020', '5030',
                        '5100', '5110', '5120', '5130', '5140', '5150', '5160', '5165',
                        '5200', '5220', '5230', '5240', '5250', '5260',
                        '5300', '5310', '5320', '5330', '5340', '5350', '5360',
                        '5400', '5410', '5420',
                        '5500', '5510', '5520', '5530', '5540', '5550', '5560',
                        '5600', '5610', '5620', '5630', '5700',
                        '5800', '5810', '5820', '5840', '5850', '5860',
                        '5900', '5910', '5920', '5940',
                        '6005', '6010', '6040', '6050', '6100', '6120', '6130',
                        '6200', '6210', '6220', '6230', '6240', '6250', '6260',
                        '6300', '6320', '6330', '6355', '6360', '6400', '6420', '6440', '6460',
                        '6515', '6520', '6530', '6600', '6660',
                        '6700', '6710', '6720', '6730', '6740', '6765',
                        '6800', '6820', '6830', '6840', '6940',
                        '7000', '7010', '7020', '7030', '7040',
                        '7100', '7110', '7120', '7130', '7140', '7150', '7160',
                        '7200', '7210', '7220', '7240', '7260',
                        '7300', '7315', '7320', '7330', '7340', '7350', '7360',
                        '7410', '7420', '7430', '7510', '7540', '7560', '7610', '7630',
                        '7700', '7710', '7720', '7730', '7740', '7750',
                        '7800', '7810', '7830', '7840', '7850', '7855',
                        '7900', '7920', '7930', '7940', '7950',
                        '8030', '8040', '8100', '8130', '8140',
                        '8220', '8250', '8255', '8256',
                        '8300', '8310', '8320', '8330', '8350',
                        '8400', '8410', '8420', '8450', '8460',
                        '8500', '8510', '8530', '8540', '8550',
                        '8600', '8610', '8620', '8630', '8640', '8650',
                        '8710', '8720', '8730', '8740', '8750', '8760',
                        '8800', '8810', '8830', '8850',
                        '8910', '8920', '8930', '8940', '8950', '8965',
                        '9000', '9030', '9040', '9050',
                        '9110', '9120', '9130', '9140', '9150', '9200', '9240', '9260',
                        '9300', '9310', '9350', '9360', '9410', '9415', '9420',
                        '9510', '9520', '9560', '9600', '9610', '9620', '9630', '9640', '9650',
                        '9720', '9750', '9800', '9810', '9820', '9830', '9920'],
            'PAOC'     : ['1', '2', '3', '4'],
            'POWSP'    : ['001', '002', '004', '005', '006', '008', '009',
                          '010', '011', '012', '013', '015', '016', '017', '018', '019',
                          '020', '021', '022', '023', '024', '025', '026', '027', '028', '029',
                          '030', '031', '032', '033', '034', '035', '036', '037', '038'  '039',
                          '040', '041', '042', '044', '045', '046', '047', '048', '049',
                          '050', '051', '053', '054', '055', '056', '072',
                          '166', '251', '254', '301', '303', '399', '555'],
            'SCIENGP'  : ['1', '2'],
            'SCIENGRLP': ['1', '2'],
            'SFN'      : ['1', '2', '3', '4'],
            'SFR'      : ['1', '2', '3', '4', '5', '6'],
            # 'SOCP'     : ['1110XX', '111021', '112011', '112020', '112031',
            #               '113011', '113021', '113031', '113051',  '113061', '113071',
            #               '113111', '113121', '113131',
            #               '119013', '119021', '119030', '119041', '119051', '119071', '119081',
            #               '119111', '119121', '119141', '119151', '119161', '119XXX',
            #               '131011', '131021', '131022', '131023', '131030', '131041', '131051',
            #               '131070', '131081',
            #               '131111', '131121', '131131', '131141', '131151', '131161', '131199',
            #               '132011', '132021', '132031', '132041', '132051', '132052', '132053',
            #               '132061', '132070', '132081', '132082', '132099',
            #               '151111', '151121', '151122', '151131', '15113X', '151134',
            #               '151141', '151142', '151143', '151150', '151199',
            #               '152011', '152031', '1520XX',
            #               '171010', '171020', '172011', '1720XX', '172041', '172051',
            #               '172061', '172070', '172081',
            #               '172110', '172121', '172131', '172141', '1721XX', '1721YY',
            #               '173010', '173020', '173031',
            #               '191010', '191020', '191030', '1910XX',
            #               '192010', '192021', '192030', '192040', '192099',
            #               '193011', '193030', '193051', '1930XX',
            #               '194011', '194021', '194031', '1940XX', '1940YY',
            #               '211010', '211020', '211092', '211093', '21109X',
            #               '212011', '212021', '212099',
            #               '2310XX', '231012', '232011', '232090',
            #               '251000', '252010', '252020', '252030', '252050',
            #               '253000', '254010', '254021', '254031', '259041', '2590XX',
            #               '271010', '271020', '272011', '272012', '272020', '272030', '272040', '272099',
            #               '273010', '273020', '273031', '273041', '273042', '273043', '273090',
            #               '2740XX', '274021', '274030',
            #               '291011', '291020', '291031', '291041', '291051', '291060', '291071', '291081',
            #               '291122', '291123', '291124', '291125', '291126', '291127', '29112X',
            #               '291131', '291141', '291151', '291181', '291199', '2911XX',
            #               '292010', '292021', '292030', '292041', '292050', '292061', '292071', '292081', '292090',
            #               '299000', '311010', '312010', '312020',
            #               '319011', '319091', '319092', '319094', '319095', '319096', '319097', '31909X',
            #               '331011', '331012', '331021', '331099', '332011', '332020', '333010', '333021',
            #               '3330XX', '333050', '339011', '339021', '339030', '339091', '339093', '33909X',
            #               '351011', '351012', '352010', '352021', '353011', '353021', '353022', '353031', '353041',
            #               '3590XX', '359021', '359031', '371011', '371012', '37201X', '372012', '372021', '373010',
            #               '391010', '391021', '392011', '392021', '393010', '393021', '393031', '393090',
            #               '394031', '3940XX', '395011', '395012', '395090', '396010', '397010',
            #               '399011', '399021', '399030', '399041', '399099',
            #               '411011', '411012', '412010', '412021', '412022', '412031',
            #               '413011', '413021', '413031', '413041', '413099', '414010',
            #               '419010', '419020', '419031', '419041', '419091', '419099',
            #               '431011', '432011', '432021', '432099', '433011', '433021', '433031',
            #               '433041', '433051', '433061', '433071', '433099',
            #               '434011', '434031', '434041', '434051', '434061', '434071', '434081',
            #               '434111', '434121', '434131', '434141', '434XXX', '434161', '434171', '434181', '434199',
            #               '435011', '435021', '435030', '435041', '435051', '435052', '435053', '435061', '435071',
            #               '435081', '435111', '436010',
            #               '439011', '439021', '439022', '439041', '439051', '439061', '439071', '439081',
            #               '439111', '439XXX',
            #               '451011', '452011', '452041', '4520XX', '453000', '454011', '454020',
            #               '471011', '472011',
            #               '472031', '472040', '472050', '472061', '472071', '47207X', '472080',
            #               '472111', '472121', '472130', '472140', '472150', '472161', '472181',
            #               '472211', '472221', '472XXX', '473010', '474011', '474021', '474031',
            #               '474041', '474051', '474061', '47XXXX',
            #               '4750YY', '475021', '475031', '475040', '4750XX',
            #               '491011', '492011', '492020', '492091', '492092', '49209X', '492096', '492097', '492098',
            #               '493011', '493021', '493022', '493023', '493031', '493040', '493050', '493090',
            #               '499010', '499021', '499031', '49904X', '499043', '499044', '499051', '499052',
            #               '499060', '499071', '499091', '499094', '499096', '499098', '4990XX',
            #               '511011', '512011', '512020', '512031', '512041', '512090',
            #               '513011', '513020', '513091', '513092', '513093', '513099',
            #               '514010', '514021', '514022', '514023', '514030',
            #               '514041', '514050', '5140XX', '514111', '514120', '514XXX',
            #               '515111', '515112', '515113', '516011', '516021', '516031', '516040',
            #               '516050', '51606X', '516063', '516064', '516093', '51609X',
            #               '517011', '517021', '517041', '517042', '5170XX',
            #               '518010', '518021', '518031', '518090',
            #               '519010', '519020', '519030', '519041', '519051', '519061', '519071', '519080',
            #               '519111', '519120', '519151', '519191', '519194', '519195', '519196', '519197',
            #               '519198', '5191XX',
            #               '531000', '532010', '532020', '532031', '533011', '533020', '533030', '533041', '533099',
            #               '534010', '534031', '5340XX', '5350XX', '535020',
            #               '536021', '536031', '536051', '536061', '5360XX',
            #               '537021', '537030', '5370XX', '537051', '537061', '537062', '537063', '537064',
            #               '537070', '537081', '5371XX',
            #               '551010', '552010', '553010', '559830',
            #               '999920'],
            'VPS'      : ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15'],
            'YOEP'     : ['1922','1924','1926','1928',
                          '1930','1932','1935','1937','1939',
                          '1940','1941','1942','1943','1945','1946','1947','1948','1949',
                          '1950','1951','1952','1953','1954','1955','1956','1957','1958','1959',
                          '1960','1961','1962','1963','1964','1965','1966','1967','1968','1969',
                          '1970','1971','1972','1973','1974','1975','1976','1977','1978','1979',
                          '1980','1981','1982','1983','1984','1985','1986','1987','1988','1989',
                          '1990','1991','1992','1993','1994','1995','1996','1997','1998','1999',
                          '2000','2001','2002','2003','2004','2005','2006','2007','2008','2009',
                          '2010','2011','2012','2013','2014','2015','2016']
         }

        self.range_validation_no_nulls = {
            'AGEP'    : [0.0, 99.0],
            'SPORDER' : [1.0, 20.0]  #synthesized data may not contain this column
        }

        self.range_validation_has_nulls = {
            'INTP'    : [-9999.0, 999999.0],
            'JWMNP'   : [1.0, 200.0],
            'MARHYP'  : [1932.0, 2016.0],
            'OIP'     : [0.0, 99999.0],
            'PAP'     : [0.0, 99999.0],
            'RETP'    : [0.0, 999999.0],
            'SEMP'    : [-10000.0, 999999.0],
            'SSIP'    : [0.0, 99999.0],
            'SSP'     : [0.0, 99999.0],
            'WAGP'    : [0.0, 999999.0],
            'WKHP'    : [1.0, 99.0],
            'PERNP'   : [-10000.0, 9999999.0],
            'PINCP'   : [-19999.0, 9999999.0],
            'POVPIP'  : [0.0, 501.0]
        }

        self.leading_zeros = {
            'PUMA'    : ['00100', '70301'],
            'POWPUMA' : ['00001', ['00100', '70100']],
            'MIGPUMA' : ['00001', '00002', ['00100', '70100']]
        }

    def build_relationship_aggregate(self, relationship, column_name, has_nulls, value_type):
        if (value_type == 'list' and has_nulls):
            relationship.add_aggregate(aggregator=Asserts.list_count,
                                       comparator=Asserts.count_greater_than,
                                       extra_aggregator_params={'column': column_name,
                                                                'value_list': self.list_validation_has_nulls[column_name],
                                                                'has_null': has_nulls},
                                       extra_comparator_params={'expected_value': False,
                                                                'greater_than': 0})


        if (value_type == 'list' and not has_nulls):
            relationship.add_aggregate(aggregator=Asserts.list_count,
                                       comparator=Asserts.count_greater_than,
                                       extra_aggregator_params={'column': column_name,
                                                                'value_list': self.list_validation_no_nulls[column_name],
                                                                'has_null': has_nulls},
                                       extra_comparator_params={'expected_value': False,
                                                                'greater_than': 0})

        if (value_type == 'range' and has_nulls):
            relationship.add_aggregate(aggregator=Asserts.range_count,
                                       comparator=Asserts.count_greater_than,
                                       extra_aggregator_params={'column': column_name,
                                                                'value_list': self.range_validation_has_nulls[column_name],
                                                                'has_null': has_nulls},
                                       extra_comparator_params={'expected_value': False,
                                                                'greater_than': 0})

        if (value_type == 'range' and not has_nulls):
            relationship.add_aggregate(aggregator=Asserts.range_count,
                                       comparator=Asserts.count_greater_than,
                                       extra_aggregator_params={'column': column_name,
                                                                'value_list': self.range_validation_no_nulls[column_name],
                                                                'has_null': has_nulls},
                                       extra_comparator_params={'expected_value': False,
                                                                'greater_than': 0})
        if (value_type == 'leading_zeros'):
            relationship.add_aggregate(aggregator=Asserts.leading_zeros_count,
                                       comparator=Asserts.count_greater_than,
                                       extra_aggregator_params={'column': column_name,
                                                                'value_list': self.leading_zeros[column_name],
                                                                'has_null': has_nulls},
                                       extra_comparator_params={'expected_value': False,
                                                                'greater_than': 0})


    def dataset_asserts(self, has_nulls, value_type):
        assert_list = []
        relationship = analytics.Assertion()

        if (value_type=='list'):
            if (has_nulls):
                for key, value in self.list_validation_has_nulls.items():
                    self.build_relationship_aggregate(relationship=relationship, column_name=key, has_nulls=True, value_type='list')
            else: #no_nulls
                for key, value in self.list_validation_no_nulls.items():
                    self.build_relationship_aggregate(relationship=relationship, column_name=key, has_nulls=False, value_type='list')

        if (value_type=='range'):
            if (has_nulls):
                for key, value in self.range_validation_has_nulls.items():
                    self.build_relationship_aggregate(relationship=relationship, column_name=key, has_nulls=True, value_type='range')
            else: #no nulls
                for key, value in self.range_validation_no_nulls.items():
                    self.build_relationship_aggregate(relationship=relationship, column_name=key, has_nulls=False, value_type='range')

        if (value_type=='leading_zeros'):
            for key, value in self.leading_zeros.items():
                self.build_relationship_aggregate(relationship=relationship, column_name=key, has_nulls=True, value_type='leading_zeros')

        assert_list.append(relationship)
        return assert_list


if __name__ == "__main__":

    fileInputLoc = '/Users/micahheineck/Documents/Knexus/CenSyn/data/original-persons-IL-2016.parquet'

    df = ParquetDataSource(path_to_file=fileInputLoc).to_dataframe()
    #('features.json').feature_definitions - this should build lists from bins
    Asserts.get_dataframe_details(df)

    print('\n1. VALIDATION OF FEATURES IN A LIST - NO NULLS ALLOWED')
    print('_______________________________________________________________________________________\n')
    assert_list = Asserts().dataset_asserts(has_nulls=False, value_type='list')
    results = [item.execute(df=df) for item in assert_list]
    for result in results:
        for r in result[1]:
            print(r)

    print('\n2. VALIDATION OF FEATURES IN A LIST - NULLS ALLOWED')
    print('____________________________________________________________________________________\n')

    assert_list = Asserts().dataset_asserts(has_nulls=True, value_type='list')
    results = [item.execute(df=df) for item in assert_list]
    for result in results:
        for r in result[1]:
            print(r)

    print('\n3.VALIDATION OF FEATURES WITHIN A RANGE - NO NULLS ALLOWED')
    print('____________________________________________________________________________________\n')

    assert_list = Asserts().dataset_asserts(has_nulls=False, value_type='range')
    results = [item.execute(df=df) for item in assert_list]
    for result in results:
        for r in result[1]:
            print(r)

    print('\n4.VALIDATION OF FEATURES WITHIN A RANGE NULLS ALLOWED')
    print('____________________________________________________________________________________\n')

    assert_list = Asserts().dataset_asserts(has_nulls=True, value_type='range')
    results = [item.execute(df=df) for item in assert_list]
    for result in results:
        for r in result[1]:
            print(r)

    print('\n5.VALIDATION OF FEATURES WITH LEADING ZEROS')
    print('____________________________________________________________________________________\n')

    assert_list = Asserts().dataset_asserts(has_nulls=True, value_type='leading_zeros')
    results = [item.execute(df=df) for item in assert_list]
    for result in results:
        for r in result[1]:
            print(r)


ALL_ACS_ASSERTS_LIST = []
ALL_ACS_ASSERTS_LIST.extend(Asserts().dataset_asserts(has_nulls=False, value_type='list'))
ALL_ACS_ASSERTS_LIST.extend(Asserts().dataset_asserts(has_nulls=True, value_type='list'))
    # ALL_ACS_ASSERTS_LIST.extend(Asserts().dataset_asserts(has_nulls=False, value_type='range'))
    # ALL_ACS_ASSERTS_LIST.extend(Asserts().dataset_asserts(has_nulls=True, value_type='range'))
    # ALL_ACS_ASSERTS_LIST.extend(Asserts().dataset_asserts(has_nulls=True, value_type='leading_zeros'))


# todo write specific functions for the variables with the odd date bounds - CITWP, YOEP, ...